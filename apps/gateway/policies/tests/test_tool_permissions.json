{
  "test_cases": [
    {
      "name": "risky_tool_block",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Delete all files"
          }
        ],
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "delete_file",
              "description": "Delete a file"
            }
          }
        ],
        "metadata": {
          "ai_shield_preset": "kmu_standard",
          "compatibility_mode": "block"
        }
      },
      "expected": {
        "decision": "block",
        "reason_codes": ["risky_tool_detected"]
      }
    },
    {
      "name": "safe_tool_allow",
      "input": {
        "messages": [
          {
            "role": "user",
            "content": "Get the weather"
          }
        ],
        "tools": [
          {
            "type": "function",
            "function": {
              "name": "get_weather",
              "description": "Get weather information"
            }
          }
        ],
        "metadata": {
          "ai_shield_preset": "kmu_standard",
          "compatibility_mode": "block"
        }
      },
      "expected": {
        "decision": "allow",
        "reason_codes": []
      }
    }
  ]
}

